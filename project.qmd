---
title: "BDA PROJECT"
author: Axel, Linnea, Elissa
format: 
  html:
    toc: true
    code-tools: true
    code-line-numbers: true  
    number-sections: true
    mainfont: Georgia, serif
    page-layout: article
  pdf:  
    geometry:
    - left=1cm,top=1cm,bottom=1cm,right=7cm
    number-sections: true
    code-annotations: none
editor: source
---

# Set up

## Loading the required packages

```{r}
library(carData)
library(ggplot2)
library(dplyr)
```

# Datasets

## Migraine data

```{r}
# Migraines after treatment -  time series data
data("KosteckiDillon")
head(KosteckiDillon)

# rename the data
migraine <- KosteckiDillon
```

## Other datasets

```{r}
library(survival)
data(transplant)
head(transplant)

library(AER)
data(ResumeNames)
head(ResumeNames)

nrow(ResumeNames)

```

# Plots

```{r}
ggplot(transplant, aes(x = event)) + geom_bar()
```

```{r}
plt <- ggplot(data = migraine, aes(x = dos)) + 
  geom_histogram()
plt
```

```{r}
migraine %>%
    group_by(id) %>%
    # filter(dos < 200) %>%
    ggplot(aes(x=dos, y=airq, group=id, color=headache)) + geom_line()

migraine %>% filter(id == 2)
```

```{r}
# head(migraine)
migraine %>%
    group_by(id) %>%
    filter(time == min(time)) %>%
    ungroup() %>%
    ggplot(aes(x=headache, fill=medication)) + geom_bar(stat="count")
```

```{r}
migraine %>%
    group_by(id) %>%
    filter(time == max(time)) %>%
    ungroup() %>%
    ggplot(aes(x=headache, fill=medication)) + geom_bar(stat="count")
```

```{r}
migraine_freqs <- migraine %>%
    select(time, headache) %>%
    group_by(time) %>%
    mutate(freqs_no = sum(headache == "no"),
          freqs_yes = sum(headache == "yes"),
          time = time,
          freqs_total = freqs_no + freqs_yes,
          freqs_frac_no = freqs_no / freqs_total,
          freqs_frac_yes = freqs_yes / freqs_total) 
migraine_freqs
```

```{r}
migraine_freqs

ggplot(migraine_freqs, aes(x=time, y=freqs_frac_no)) +
    geom_line(color="deeppink") 
    # geom_line(aes(y=freqs_frac_yes), color="seagreen") 
```